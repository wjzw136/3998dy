<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport"
        content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>Hello APP</title>
    <link rel="stylesheet" type="text/css" href="./css/api.css" />
    <link rel="stylesheet" type="text/css" href="./css/aui.css" />
    <link rel="stylesheet" type="text/css" href="./css/public.css" />
    <style type="text/css">
        #header {
            height: 120px;
        }
    </style>
</head>

<body>
    <div id="wrap">
        <div id="header" class="header">

        </div>
        <div id="main">

        </div>
        <div id="footer">
            <footer class="aui-bar aui-bar-tab">
                <div class="aui-bar-tab-item aui-active" tapmode>
                    <i class="aui-iconfont aui-icon-home"></i>
                    <div class="aui-bar-tab-label">游戏</div>
                </div>
                <div class="aui-bar-tab-item" tapmode>
                    <i class="aui-iconfont aui-icon-star"></i>
                    <div class="aui-bar-tab-label">福利</div>
                </div>

                <div class="aui-bar-tab-item" tapmode>
                    <div class="aui-dot"></div>
                    <i class="aui-iconfont aui-icon-my"></i>
                    <div class="aui-bar-tab-label">我的</div>
                </div>
            </footer>
        </div>

    </div>
</body>
<script type="text/javascript" src="./script/api.js"></script>
<script type="text/javascript">
    apiready = function () {
        var header = $api.byId('header');
        //适配iOS 7+，Android 4.4+状态栏
        var HeaderHeight = [100, 200, 50];

        //var headerPos = $api.offset(header);
        var main = $api.byId('main');
        // $api.fixStatusBar(header);
        var mainPos = $api.offset(main);
        var gllis = $api.domAll('.aui-bar-tab-item');
        //切换点击
        Array.prototype.forEach.call(gllis, function (btn) {
            btn.addEventListener('click', function (event) {
                var index = 0;
                for (var i = 0, len = gllis.length; i < len; i++) {
                    if (btn == gllis[i]) {
                        index = i;
                        openheaderFrame(shouye_frames_name[index], HeaderHeight[index]);
                        $api.addCls(gllis[index], 'aui-active');
                        if (i == 0) {


                            api.openFrameGroup({
                                name: 'shouye_group',
                                scrollEnabled: true,
                                rect: {
                                    x: 0,
                                    y: HeaderHeight[0],
                                    w: api.winWidth,
                                    h: api.winHeight - HeaderHeight[0] - 50
                                },
                                preload: shouye_frames_name.length,
                                index: 0,
                                frames: shouye_frames
                            }, function (ret, err) {
                                api.setFrameGroupAttr({
                                    name: 'fuli_group',
                                    hidden: true
                                });

                                api.setFrameAttr({
                                    name: 'fuli_header',
                                    hidden: true
                                });
                                api.setFrameAttr({
                                    name: 'me_header',
                                    hidden: true
                                });
                                api.setFrameAttr({
                                    name: 'me',
                                    hidden: true
                                });
                            });
                            // api.setFrameGroupAttr({
                            //     name: 'shouye_group',
                            //     hidden: false,
                            //     rect: {
                            //         x: 0,
                            //         y: HeaderHeight[0],
                            //         w: api.winWidth,
                            //         h: api.winHeight - HeaderHeight[0] - 50
                            //     }
                            // })




                        } else if (i == 1) {
                            api.openFrameGroup({
                                name: 'fuli_group',
                                scrollEnabled: true,
                                rect: {
                                    x: 0,
                                    y: HeaderHeight[1],
                                    w: api.winWidth,
                                    h: api.winHeight - HeaderHeight[1] - 50
                                },
                                preload: fuli_frames_name.length,
                                index: 0,
                                frames: fuli_frames
                            }, function (ret, err) {
                                api.setFrameGroupAttr({
                                    name: 'shouye_group',
                                    hidden: true
                                });
                                api.setFrameAttr({
                                    name: 'shouye_header',
                                    hidden: true
                                });
                                api.setFrameAttr({
                                    name: 'me_header',
                                    hidden: true
                                });
                                api.setFrameAttr({
                                    name: 'me',
                                    hidden: true
                                });
                            });
                            // api.setFrameGroupAttr({
                            //     name: 'fuli_group',
                            //     hidden: false,
                            //     rect: {
                            //         x: 0,
                            //         y: HeaderHeight[1],
                            //         w: api.winWidth,
                            //         h: api.winHeight - HeaderHeight[1] - 50
                            //     }
                            // });






                        } else {

                            api.openFrame({
                                name: 'me',
                                url: './html/me.html',
                                bounces: true,
                                rect: {
                                    x: 0,
                                    y: HeaderHeight[2],
                                    w: 'auto',
                                    h: api.winHeight - HeaderHeight[2] - 50
                                }
                            });
                            api.setFrameGroupAttr({
                                name: 'shouye_group',
                                hidden: true
                            });
                            api.setFrameGroupAttr({
                                name: 'fuli_group',
                                hidden: true
                            });

                            api.setFrameAttr({
                                name: 'fuli_header',
                                hidden: true
                            });
                            api.setFrameAttr({
                                name: 'shouye_header',
                                hidden: true
                            });
                        }


                    } else {
                        $api.removeCls(gllis[i], 'aui-active');
                    }
                }
            })
        })


        var fuli_frames = [];
        var fuli_frames_name = ['1', '2', '3'];
        for (var i = 0, len = fuli_frames_name.length; i < len; i++) {
            fuli_frames.push({
                name: fuli_frames_name[i],
                url: './html/' + fuli_frames_name[i] + '.html',
                bgColor: 'rgba(0,0,0,2)',
                bounces: true
            })
        }
        api.openFrameGroup({
            name: 'fuli_group',
            scrollEnabled: true,
            rect: {
                x: 0,
                y: HeaderHeight[1],
                w: api.winWidth,
                h: api.winHeight - HeaderHeight[1] - 50
            },
            preload: fuli_frames_name.length,
            index: 0,
            frames: fuli_frames
        }, function (ret, err) {
        });
        //创建shouye窗口
        var app_group = ['shouye_group', 'fuli_group'];

        var shouye_frames = [];
        var shouye_frames_name = ['shouye', 'fuli', 'me'];
        for (var i = 0, len = shouye_frames_name.length; i < len; i++) {
            shouye_frames.push({
                name: shouye_frames_name[i],
                url: './html/' + shouye_frames_name[i] + '.html',
                bgColor: 'rgba(0,0,0,2)',
                bounces: true
            })
        }
        api.openFrameGroup({
            name: 'shouye_group',
            scrollEnabled: true,
            rect: {
                x: 0,
                y: HeaderHeight[0],
                w: api.winWidth,
                h: api.winHeight - HeaderHeight[0] - 50
            },
            preload: shouye_frames_name.length,
            index: 0,
            frames: shouye_frames
        }, function (ret, err) {
        });

        //创建fuli窗口

        api.setFrameGroupAttr({
            name: 'fuli_group',
            hidden: true
        });

        openheaderFrame(shouye_frames_name[0], HeaderHeight[0]);
    }

    function openheaderFrame(x, y) {
        api.openFrame({
            name: x + '_header',
            url: './html/' + x + '_header.html',
            bounces: false,
            scrollEnabled: true,
            // animation: {
            //     type: "fade",                //动画类型（详见动画类型常量）
            //     subType: "from_right",       //动画子类型（详见动画子类型常量）
            //     duration: 300                //动画过渡时间，默认300毫秒
            // },
            rect: {
                x: 0,
                y: 0,
                w: 'auto',
                h: y
            }
        });
    }
</script>

</html>